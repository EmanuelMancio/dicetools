# DICEtools
Repository of selected Python 3 scripts used to aid data analysis and input generation of Monte Carlo and Configurational Bias Monte Carlo simulations performed with Dice.


## Dependencies
To use the scripts a few Python 3 dependencies are needed, for example
- [NumPy](http://www.numpy.org/)
- [OpenBabel](http://openbabel.org/)
- [matplotlib](https://matplotlib.org/)

The number of dependencies may vary depending on which analysis script one is using, those are just the most common used in almost all the scripts.
You can install these dependencies in any way you want, however, we encourage the use of the [Anaconda](https://www.anaconda.com/download/) Python distribution.
To install the libraries with Anaconda, do the following:
```
conda install numpy
conda install -c openbabel openbabel
conda install matplotlib
```

If you want to use the graphical interface of DiceWin to perform some analysis, you will also need some stuff like:
- [SciPy](https://www.scipy.org/) 
- [SIP](https://pypi.org/project/SIP/)
- [PyQt5](https://riverbankcomputing.com/software/pyqt/intro)

that can also be easily installed with conda with
```
conda install scipy
conda install sip
conda install pyqt=5
```

## Short description of tools
All the scripts can be run with the `-h` option to show a brief description of what the script does and the mandatory and optional parameters.

### ang_distr_from_torsionals.py
Receives the file name of a file containing data of a angle (or torsional angle) as one number per line, and an integer (number of bins) to give a file "pdf.dat" and a plot of the probability density function interpolated from the histogram.

### calculate_angles.py
Receives a file containing a molecular trajectory in any format supported by OpenBabel, and 3 integers (indexes of atoms) to compute the angle between the atoms and print it to screen.

### calculate_dihedrals.py
Same as calculate_angles.py, but receives 4 integers defining a dihedral angle.

### calculate_dipoles.py
Given a .xyz file with a trajectory and a .txt DICE input to print the dipole moment for each configuration.

### clean_dof_dfr.py
Receives a .dfr DICE input that had some fragment types changed to "R" (rigid) and simplifies the .dfr removing unecessary information related to the rigid degrees of freedom.

### dicewin.py
Graphical user interface that can open files generated by DICE to plot the evolution of properties with the simulation steps, plot all the radial distribution functions, calculate statistical correlation and more. The interface is very intuitive, but for more information you can see the [manual](man/dicewin_manual.pdf) (unfortunately, just in Portuguese at the moment).

### dihedral_step_evolution.py
Receives a file containing several angles (normally a dihedral angles) one in each line and an integer (usually the interval "isave" used in DICE input) to plot how this angle changed during a simulation.

### distance_evolution.py
Receives a trajectory and two integer (atom indexes) to plot the evolution of a distance with the simulation steps.

### estimate_variance_timeseries.py
Receives a file containing a series of numbers, one in each line (usually the output of calculate_dihedrals.py), classifies all the values as belonging to a group in [min,max] or [min2,max2] or not and then estimate the variance, or how much the populations deviate from the others inside each one of the "nwindows" (integer parameter).

### fragGen.py
The fragGen is an script used to generate the input for CBMC simulations with DICE. It receives a file containing the geometry for a molecule in any format supported by OpenBabel to generate the .dfr and .txt files. 
fragGen always generates the maximum fragmentation of the molecule, breaking the molecule into the rotatable bonds.
After running fragGen, the user still needs to specify the force field parameters in the .dfr and .txt

### get_solute_xyz.py
Given a .xyz file and an integer representing the number of atoms, print the first "natoms" atoms for the molecule as a .xyz. Usually used to extract the solute configurations from the simulation boxes, with "natoms" being the number of atoms of the solute.

### gromacs2dice.py
Receives a GROMACS topology file (.top or .itp) and a file containing the geometry of the molecule (with the atoms in the same order) in .gro or any format supported by OpenBabel.


### plot_eff_tors.py

### plot_en_angle_gaussian_scan.py

### probability_interval.py

### separate_configs_box.py


## Authorship
Most of the scripts here were written by Henrique Musseli Cezar, with the exception of DiceWin which was written by Thiago de Souza Duarte.
These tools were written with the important contribution of Prof. Kaline Coutinho, who supervised the work and gave suggestions to the improvement of the tools.


## Acknowledgments
We thank the Brazilian funding agencies [CNPq](http://www.cnpq.br/) and [CAPES](http://www.capes.gov.br/) for the fellowships and the approved research projects.
Most of this work was done under a CNPq PhD fellowship for Henrique Musseli Cezar (grant number 140489/2015-0) and undergraduate research fellowships for Thiago de Souza Duarte.